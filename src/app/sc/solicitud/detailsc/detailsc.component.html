<nav class="lafar-bg-blue">
    <div class="nav-wrapper">
        <div class="left col s12 m5 l5">
            <ul>
                <li><a href="javascript:void(0);" [routerLink]="['/sc/solicitud/list']" class="email-menu"><i class="modal-action modal-close  mdi-hardware-keyboard-backspace"></i></a>
                </li>
                <li><a href="javascript:void(0);" class="email-type">Detalle de la Solicitud  {{codigo_solicitud}}</a>
                </li>
            </ul>
        </div>
        <div class="col s12 m7 l7 hide-on-med-and-down">
            <ul class="right">
                <!--<li><a href="javascript:void(0);"><i class="mdi-editor-attach-file"></i></a></li>-->
                <li><a href="javascript:void(0);" (click)="onDirigirConversacion()"><i class="modal-action modal-close  mdi-communication-textsms"></i></a></li>
            </ul>
        </div>
    </div>
</nav>

<form #form="ngForm" novalidate>

<mz-card>
    <mz-card-content>
        <div class="row">
            <mz-input-container class="col s12 m3">
                <input mz-input disabled
                [label]="'Codigo de Solicitud'"
                id="codigo"
                [(ngModel)]="solicitud.codigo"
                name="codigo"
                placeholder="Codigo de Solicitud"
                type="text">
            </mz-input-container>

            <mz-select-container class="col s12 m3">
                <select mz-select mz-validation required
                    id="tipo"
                    [disabled]= "!modificar"
                    [errorMessageResource]="errorMessagesSolicitud.tipo"
                    [(ngModel)]="solicitud.tipo"
                    name="tipo"
                    [label]="'Tipo de Solicitud'"
                    [placeholder]="'Tipo de Solicitud'">
                    <option value="I">Articulo</option>
                    <option value="S">Servicio</option>
                </select>
            </mz-select-container>

            <mz-datepicker-container class="col s12 m3">
                <i mz-icon-mdi mz-input-prefix
                    [icon]="'calendar'">
                </i>
                <input mz-datepicker mz-validation required disabled
                    [errorMessageResource]="errorMessagesSolicitud.fecha"
                    [label]="'Fecha de Solicitud'"
                    [options]="opcionesDatePicker"
                    [(ngModel)]="solicitud.fecha"
                    name="fecha"
                    id="fecha"
                    type="tel" />
            </mz-datepicker-container>

            <mz-select-container class="col s12 m3">
                <select mz-select
                    [disabled]= "!modificar"
                    id="tipo_compra"
                    [(ngModel)]="solicitud.tipo_compra"
                    name="tipo_compra"
                    [label]="'Tipo de Compra'"
                    [placeholder]="'Tipo de Compra'">
                    <option value="L">Local</option>
                    <option value="I">Importación</option>
                    <option value="G">General</option>
                </select>
            </mz-select-container>
        </div>
        <div class="row">
            <div class="col s12 m4">
                <span class="title_select">Codigo de Proveedor</span>
                <ng-select required
                    #SelectCodigoProveedor
                    [disabled]= "!modificar"
                    [items]="proveedores"
                    bindLabel="CardCode"
                    bindValue="CardCode"
                    (change) = "OnLoadDatosProveedor($event)"
                    [(ngModel)]="solicitud.codigo_proveedor"
                    name="codigo_proveedor">
                </ng-select>
            </div>

            <div class="col s12 m8">
                <span class="title_select">Nombre de Proveedor</span>
                <ng-select required
                    #SelectNombreProveedor
                    [items]="proveedores"
                    [disabled]= "!modificar"
                    bindLabel="CardName"
                    bindValue="CardName"
                    (change) = "OnLoadDatosProveedor($event)"
                    [(ngModel)]="solicitud.nombre_proveedor"
                    name="nombre_proveedor">
                </ng-select>
            </div>

            <!--<mz-datepicker-container class="col s12 m4">
                <i mz-icon-mdi mz-input-prefix
                    [icon]="'calendar'">
                </i>
                <input mz-datepicker
                    [label]="'Fecha Necesaria'"
                    id="prefix-datepicker"
                    type="tel" />
            </mz-datepicker-container>-->
        </div>
        <div class="row">
            <mz-input-container class="col s12 m9">
                <input mz-input
                    [disabled]= "!modificar"
                    [label]="'Motivo de la Solicitud'"
                    id="motivo"
                    [(ngModel)]="solicitud.motivo"
                    name="motivo"
                    placeholder="Ingrese el Motivo de la Solicitud"
                    type="text">
            </mz-input-container>
            <div class="col s12 m3">
                <br>
                <button *ngIf="tipo_solicitud" 
                    [disabled]= "!modificar"
                    mz-button (click)="AddItemModal.open()">
                    <i mz-icon-mdi [icon]="'cart-plus'" [align]="'left'"></i>
                    Agregar Items
                </button>
            </div>
        </div>
    </mz-card-content>
</mz-card>

<mz-card>
    <mz-card-content>
        <table id="table-items" class="highlight responsive-table">
            <tr>
                <th>Codigo</th>
                <th>Descripción</th>
                <th>Unidad</th>
                <th>Cantidad</th>
                <th>Fec. Requerida</th>
                <th>Opciones</th>
            </tr>
            <tr class="border_bottom" *ngFor="let ds of ldetallesolicitud">
                <td>{{ ds.codigo_item }}</td>
                <td>{{ ds.descripcion_item }}</td>
                <td>{{ ds.unidad }}</td>
                <td>{{ ds.cantidad }}</td>
                <td>{{ ds.fecha_requerida }}</td>
                <td>
                    <button mz-button
                        [disabled]= "!modificar"
                        [float]="true" class="orange">
                        <i mz-icon-mdi [icon]="'pencil'"></i>
                    </button>
                    <button mz-button (click)="onQuitarItemSolicitud(ds.codigo_item)"
                        [disabled]= "!modificar"
                        [float]="true" class="red">
                          <i mz-icon-mdi [icon]="'minus'"></i>
                    </button>
                </td>
            </tr>
        </table>
    </mz-card-content>
</mz-card>


<!--<div class="fixed-action-btn" style="bottom: 45px; right: 24px;">
    <a href="javascript:void(0)" class="btn-floating btn-large blue" (click)="onValidaCabeceraSolicitud()">
        <i class="large mdi-navigation-check"></i>
    </a>
</div>-->

<div class="fixed-action-btn" style="bottom: 45px; right: 24px;">
    <button 
        [float]="true" mz-button 
        [disabled]="!form.valid" 
        [large]="true" 
        class="blue"
        (click)="onValidaCabeceraSolicitud()"
        type="submit"><i class="large mdi-action-done"></i>
    </button>
</div>
</form>


<form  #formDS="ngForm" novalidate>
    <mz-modal #AddItemModal [fixedFooter]="true" [fullscreen]="false" [bottomSheet]="true">
        <mz-modal-header>
            <nav class="lafar-bg-blue">
                <div class="nav-wrapper">
                    <div class="left col s12 m5 l5">
                    <ul>
                        <li><a href="javascript:void(0);" (click)="AddItemModal.close()" class="email-menu"><i class="modal-action modal-close  mdi-hardware-keyboard-backspace"></i></a></li>
                        <li><a href="javascript:void(0);" class="email-type">Agregar Nuevo Item</a></li>
                    </ul>
                    </div>
                    <div class="col s12 m7 l7 hide-on-med-and-down">
                    <ul class="right">
                        <!--<li><a href="javascript:void(0);"><i class="mdi-editor-attach-file"></i></a></li>-->
                        <li><a href="javascript:void(0);"><i class="modal-action modal-close  mdi-notification-sms"></i></a></li>
                    </ul>
                    </div>
                </div>
            </nav>
        </mz-modal-header>
        <mz-modal-content>
            <div class="row">
                <mz-datepicker-container class="col s12 m4">
                    <i mz-icon-mdi mz-input-prefix
                        [icon]="'calendar'">
                    </i>
                    <input mz-datepicker
                        [label]="'Fecha Necesaria'"
                        id="fecha_requerida"
                        [(ngModel)]="detallesolicitud.fecha_requerida"
                        name="fecha_requerida"
                        [options]= "opcionesDatePicker"
                        type="tel" />
                </mz-datepicker-container>
                <div class="col s12 m5"></div>
                <mz-input-container class="col s12 m3">
                    <input mz-input
                        [label]="'Numero de Solicitud'"
                        id="dc_codigo_solicitud"
                        placeholder="Codigo de Solicitud"
                        [(ngModel)]="solicitud.codigo"
                        name="codigo"
                        type="text">
                </mz-input-container>
            </div>
    
            <div class="row">
                <div class="col s12 m4">
                    <span class="title_select">Codigo de Item</span>
                    <ng-select
                        [items]="articulos"
                        bindLabel="ItemCode"
                        bindValue="ItemCode"
                        (change) = "OnLoadDatosArticulo($event)"
                        [(ngModel)]="detallesolicitud.codigo_item"
                        name="codigo_item">
                    </ng-select>
                </div>
    
                <div class="col s12 m8">
                    <span class="title_select">Nombre del Articulo</span>
                    <ng-select
                        [items]="articulos"
                        bindLabel="ItemName"
                        bindValue="ItemName"
                        (change) = "OnLoadDatosArticulo($event)"
                        [(ngModel)]="detallesolicitud.descripcion_item"
                        name="descripcion_item">
                    </ng-select>
                </div>
            </div>
    
            <div class="row">
                <mz-input-container class="col s12 m4">
                    <input mz-input
                        id="unidad"
                        [(ngModel)]="detallesolicitud.unidad"
                        name="unidad"
                        [label]="'Unidad'"
                        type="text">
                </mz-input-container>
                <mz-input-container class="col s12 m4">
                    <input mz-input
                        id="cantidad"
                        [(ngModel)]="detallesolicitud.cantidad"
                        name="cantidad"
                        [label]="'Cantidad'"
                        type="number">
                </mz-input-container>
                <div class="row">
                    <mz-datepicker-container class="col s12 m4">
                        <i mz-icon-mdi mz-input-prefix
                            [icon]="'calendar'">
                        </i>
                        <input mz-datepicker
                            [label]="'Fecha de Arte'"
                            id="fecha_arte"
                            [(ngModel)]="detallesolicitud.fecha_arte"
                            name="fecha_arte"
                            [options]= "opcionesDatePicker"
                            type="tel" />
                    </mz-datepicker-container>
                </div>
            </div>
            
        </mz-modal-content>
        <mz-modal-footer>
          <button mz-button [flat]="true" mz-modal-close>Cancelar</button>
          <button mz-button [flat]="true" mz-modal-close (click)="onAddItemSolicitud()">Agregar</button>
        </mz-modal-footer>
      </mz-modal>
</form>


<div class="fixed-action-btn">
    <a class="btn-floating btn-large red">
        <i class="large material-icons">mode_edit</i>
    </a>
    <ul>
        <li><a class="btn-floating red"><i class="material-icons">insert_chart</i></a></li>
        <li><a class="btn-floating yellow darken-1"><i class="material-icons">format_quote</i></a></li>
        <li><a class="btn-floating green"><i class="material-icons">publish</i></a></li>
        <li><a class="btn-floating blue"><i class="material-icons">attach_file</i></a></li>
    </ul>
</div>